{{define "content"}}

<br>
<br>
<br>
<div class="row">
    {{range $key, $value := .JobsCount}}
    <div class="col-md-2">
        <div class="card status-card text-white {{ StatusBgClass $key }}">
            <div class="card-body text-center">
                <h6 class="card-title">
                    {{ StatusIcon $key }} {{ $key }}
                </h6>
                <div class="card-text">
                    <strong>{{ $value }}</strong>
                </div>
            </div>
        </div>
    </div>
    {{end}}


</div>
<br>
<div class="row">

    <div class="col-md-12">
        <div class="row">
            <div class="col-md-4">
                <label>Status</label>
                <form action="/enqueued">
                    <select name="status" class="form-control" onchange="this.form.submit()">
                        <option value="">---all---</option>
                        {{range .Statuses}}
                        <option value="{{.}}" {{if eq . $.CurrentStatus}}selected{{end}}>{{.}}</option>
                        {{end}}
                    </select>
                </form>
            </div>
            <div class="col-md-3">
                <div>
                    Page {{ .Page }} of {{ .TotalPages }} ({{ .TotalItems }} jobs)
                </div>

                <div class="pagination">
                    {{ if .HasPreviousPage }}
                    <a class="btn btn-sm btn-primary" href="#" onclick="goToPage(this,'prev')" data-page="{{ .Page }}">Â«
                        Previous</a>
                    {{ end }}
                    &nbsp;
                    {{ if .HasNextPage }}
                    <a class="btn btn-sm btn-primary" href="#" onclick="goToPage(this,'next')" data-page="{{ .Page }}">Next
                        Â»</a>
                    {{ end }}
                </div>
            </div>
        </div>
        <br>
        <div>ðŸ•’ Recently Executed Jobs</div>
        <div class="responsive-table">
            <table class="table table-bordered">
                <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Status</th>
                    <th>Attempts</th>
                    <th>Scheduled At</th>
                    <th>Last Error</th>
                    <th>Payload</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody>
                {{ range .Items }}
                <tr>
                    <td>{{ .ID }}</td>
                    <td>{{ .Name }}</td>
                    <td><span class="{{ StatusBadgeClass .Status }}">{{ .Status }}</span></td>
                    <td>{{ .Attempts }}/{{ .MaxAttempts }}</td>
                    <td>{{ .ScheduledAt.Format "2006-01-02 15:04:05" }}</td>
                    <td>{{ if .LastError }}{{ .LastError }}{{ else }}-{{ end }}</td>
                    <td>
                        <pre>{{ printf "%s" .Payload }}</pre>
                    </td>
                    <td>
                        <div class="row">
                            <div class="col">
                                <form method="post" action="/enqueued" class="delete-form">
                                    <input type="hidden" name="action" value="remove">
                                    <input type="hidden" name="id" value="{{ .ID }}">
                                    <button type="button" class="btn btn-sm btn-danger delete-btn">Remove</button>
                                </form>
                            </div>

                        </div>

                    </td>
                </tr>
                {{ end }}
                </tbody>
            </table>
        </div>
    </div>
</div>
<br>
<br>
{{end}}
